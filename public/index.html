<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Practice Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a56db">
</head>
<body>
    <!-- Offline Indicator -->
    <div id="offlineAlert" class="offline-alert hidden">
        <i class="fas fa-wifi-slash"></i>
        <span>You're offline. Working in offline mode.</span>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo-section">
                    <i class="fas fa-book-open logo-icon"></i>
                    <div>
                        <h1>IELTS Reading Lab</h1>
                        <p class="subtitle">Practice • Submit • Get Feedback</p>
                    </div>
                </div>
                <div class="user-info">
                    <span id="studentName">Student</span>
                    <div class="band-score-display">
                        <span>Current Band:</span>
                        <span class="band-score" id="currentBand">6.5</span>
                    </div>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 65%"></div>
                <div class="progress-labels">
                    <span>0</span>
                    <span id="progressText">13/20 Tests Completed</span>
                    <span>Band 9.0</span>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="dashboard">
            <!-- Left Panel - Test Selection -->
            <div class="left-panel">
                <div class="panel-section">
                    <h2><i class="fas fa-graduation-cap"></i> Select Test</h2>
                    <div class="test-filters">
                        <button class="filter-btn active" data-type="all">All Tests</button>
                        <button class="filter-btn" data-type="academic">Academic</button>
                        <button class="filter-btn" data-type="general">General</button>
                        <button class="filter-btn" data-type="uncompleted">Uncompleted</button>
                    </div>
                    
                    <div class="test-list" id="testList">
                        <!-- Tests will be loaded here -->
                    </div>
                </div>

                <div class="panel-section">
                    <h2><i class="fas fa-chart-line"></i> Progress Statistics</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="testsCompleted">13</div>
                            <div class="stat-label">Tests Completed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avgScore">7.2</div>
                            <div class="stat-label">Average Score</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="accuracyRate">78%</div>
                            <div class="stat-label">Accuracy Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="weakArea">TFNG</div>
                            <div class="stat-label">Weak Area</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Test Interface -->
            <div class="right-panel">
                <div class="test-header">
                    <div class="test-info">
                        <h2 id="testTitle">IELTS Academic Reading Test 1</h2>
                        <div class="test-meta">
                            <span class="badge academic-badge">Academic</span>
                            <span class="time-info"><i class="far fa-clock"></i> 60 minutes</span>
                            <span class="questions-info"><i class="far fa-question-circle"></i> 40 questions</span>
                        </div>
                    </div>
                    <div class="test-controls">
                        <button id="startTestBtn" class="btn-primary">
                            <i class="fas fa-play"></i> Start Test
                        </button>
                        <button id="timerBtn" class="btn-secondary">
                            <i class="fas fa-stopwatch"></i> 
                            <span id="timerDisplay">60:00</span>
                        </button>
                    </div>
                </div>

                <!-- Test Container -->
                <div class="test-container">
                    <!-- Passage Reading Area -->
                    <div class="passage-section">
                        <div class="section-header">
                            <h3><i class="fas fa-file-alt"></i> READING PASSAGE 1</h3>
                            <button class="btn-small" id="toggleColumns">
                                <i class="fas fa-columns"></i> Toggle Columns
                            </button>
                        </div>
                        <div class="passage-content two-columns" id="passageContent">
                            <!-- Passage content will be loaded here -->
                            <p>You should spend about 20 minutes on Questions 1-13, which are based on Reading Passage 1 below.</p>
                            
                            <h4>The Rise of Vertical Farming</h4>
                            
                            <p><strong>A</strong> As the global population continues to climb toward 10 billion, traditional agriculture is struggling to keep up. Urban sprawl has consumed vast tracts of arable land, while climate change threatens crop yields. In response, agricultural innovators are looking up—literally. Vertical farming, the practice of growing crops in vertically stacked layers, often in controlled environments like skyscrapers, repurposed warehouses, or shipping containers, promises to revolutionize food production.</p>
                            
                            <p><strong>B</strong> The concept isn't entirely new. The Hanging Gardens of Babylon, one of the Seven Wonders of the Ancient World, employed terrace gardening techniques. Modern vertical farming, however, leverages advanced technologies such as hydroponics (growing plants in nutrient-rich water), aeroponics (suspending roots in air and misting them with nutrients), and aquaponics (combining fish farming with plant cultivation). These soil-free methods use up to 95% less water than conventional farming and eliminate the need for pesticides.</p>
                            
                            <!-- More passage content... -->
                        </div>
                    </div>

                    <!-- Questions Area -->
                    <div class="questions-section">
                        <div class="section-header">
                            <h3><i class="fas fa-question-circle"></i> QUESTIONS 1-13</h3>
                            <div class="question-nav">
                                <button class="btn-small" id="prevQuestion"><i class="fas fa-chevron-left"></i></button>
                                <span id="currentQuestion">Question 1 of 13</span>
                                <button class="btn-small" id="nextQuestion"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        
                        <div class="questions-container" id="questionsContainer">
                            <!-- Questions will be loaded here -->
                            <div class="question-block active" data-question="1">
                                <p class="question-text">What is the main advantage of vertical farming mentioned in paragraph A?</p>
                                <div class="options">
                                    <label class="option">
                                        <input type="radio" name="q1" value="A">
                                        <span class="option-text">It uses less water</span>
                                    </label>
                                    <label class="option">
                                        <input type="radio" name="q1" value="B">
                                        <span class="option-text">It can be done in urban areas</span>
                                    </label>
                                    <label class="option">
                                        <input type="radio" name="q1" value="C">
                                        <span class="option-text">It eliminates pesticides</span>
                                    </label>
                                    <label class="option">
                                        <input type="radio" name="q1" value="D">
                                        <span class="option-text">It increases crop variety</span>
                                    </label>
                                </div>
                                <div class="question-actions">
                                    <button class="flag-btn" data-question="1">
                                        <i class="far fa-flag"></i> Flag for review
                                    </button>
                                </div>
                            </div>
                            
                            <!-- More questions... -->
                        </div>
                        
                        <!-- Answer Sheet -->
                        <div class="answer-sheet">
                            <h4><i class="fas fa-clipboard-list"></i> Answer Sheet</h4>
                            <div class="answer-grid" id="answerGrid">
                                <!-- Answer bubbles will be generated here -->
                            </div>
                        </div>
                        
                        <!-- Submission Section -->
                        <div class="submission-section">
                            <div class="student-info-input">
                                <h4><i class="fas fa-user-edit"></i> Student Information</h4>
                                <div class="input-group">
                                    <input type="text" id="studentNameInput" placeholder="Your full name" required>
                                    <input type="text" id="studentClass" placeholder="Class/Group" required>
                                </div>
                            </div>
                            
                            <div class="submit-actions">
                                <button id="saveDraftBtn" class="btn-secondary">
                                    <i class="far fa-save"></i> Save Draft
                                </button>
                                <button id="submitTestBtn" class="btn-success">
                                    <i class="fas fa-paper-plane"></i> Submit to Telegram Group
                                </button>
                            </div>
                            
                            <div class="telegram-info">
                                <p><i class="fab fa-telegram"></i> Answers will be sent to your class Telegram group for teacher review.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>IELTS Reading Lab</h4>
                    <p>Offline-capable practice platform with instant Telegram submission.</p>
                    <div class="connection-status">
                        <span id="connectionStatus">Status: <span class="connected">Online</span></span>
                        <span id="lastSync">Last sync: Just now</span>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Features</h4>
                    <ul>
                        <li>10+ Practice Tests</li>
                        <li>Telegram Integration</li>
                        <li>Offline Support</li>
                        <li>Progress Tracking</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Teacher Tools</h4>
                    <p>Access student submissions at: <code>https://t.me/your_group</code></p>
                    <button id="teacherLogin" class="btn-small">Teacher Login</button>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 IELTS Reading Platform. For educational use only.</p>
                <div class="tech-stack">
                    <span>Built with: HTML5 • CSS3 • JavaScript • Vercel • Telegram Bot API</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modal for Teacher Login -->
    <div id="teacherModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3><i class="fas fa-chalkboard-teacher"></i> Teacher Access</h3>
            <div class="modal-body">
                <div class="telegram-webhook">
                    <h4>Telegram Bot Setup</h4>
                    <p>Webhook URL for your bot:</p>
                    <code id="webhookUrl">https://your-domain.vercel.app/api/telegram</code>
                    <button class="btn-small" onclick="copyWebhookUrl()">Copy URL</button>
                </div>
                <div class="admin-controls">
                    <h4>View Submissions</h4>
                    <a href="/api/submissions" class="btn-primary" target="_blank">View All Submissions</a>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="app.js"></script>
    
    <!-- Service Worker for Offline Capability -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed:', err));
        }
        
        // Check online status
        window.addEventListener('online', () => {
            document.getElementById('connectionStatus').innerHTML = 
                'Status: <span class="connected">Online</span>';
            document.getElementById('offlineAlert').classList.add('hidden');
            // Sync any pending submissions
            if (window.pendingSubmissions && window.pendingSubmissions.length > 0) {
                syncPendingSubmissions();
            }
        });
        
        window.addEventListener('offline', () => {
            document.getElementById('connectionStatus').innerHTML = 
                'Status: <span class="disconnected">Offline</span>';
            document.getElementById('offlineAlert').classList.remove('hidden');
        });
    </script>
</body>
</html>
